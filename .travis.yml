language: python

python:
    - "2.7"

os:
    - linux

cache:
    pip: true

sudo: false

addons:
    apt:
        sources:
            - ubuntu-toolchain-r-test
            - kalakris-cmake
        packages:
            - g++-5
            - libfftw3-dev
            - cmake

before_install:
    - pip install cffi

before_script:
    - mkdir -p ims-cpp/build
    - cd ims-cpp/build
    - if [ "$CC"  == "gcc" ]; then export CC=gcc-5; fi
    - if [ "$CXX" == "g++" ]; then export CXX=g++-5; fi
    - cmake ..
    - make ms_cffi
    - cd ../../
    - python setup.py build_egg
    - 'easy_install -U dist/*.egg'

script:
    - py.test test/
